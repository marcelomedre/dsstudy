?wday
sapply(sampleTimes12, wday)
sampleTimes12Mon <- sapply(sampleTimes12, wday)
sampleTimes12Mon <- data.table(sapply(sampleTimes12, wday))
View(sampleTimes12Mon)
sampleTimes12Mon <- data.table(sapply(sampleTimes12, wday(..., label = TRUE)))
sampleTimes12Mon <- data.table(sapply(sampleTimes12, wday(... , label = TRUE)))
sampleTimes12Mon <- data.table(sapply(sampleTimes12, wday(label = TRUE)))
sampleTimes12Mon <- data.table(sapply(sampleTimes12, wday))
wday(sampleTimes12Mon, label = TRUE)
sampleTimes12Mon <- data.table(sapply(sampleTimes12, weekdays))
View(sampleTimes12Mon)
?n
MOndays <- length(sampleTimes12Mon[grepl("segunda-feira", sampleTimes12Mon)])
MOndays
length(sampleTimes12Mon[grepl("segunda-feira", sampleTimes12Mon$sampleTimes)])
length(sampleTimes12Mon[grep("segunda-feira", sampleTimes12Mon$sampleTimes)])
length(sampleTimes12Mon(grep("segunda-feira", sampleTimes12Mon$sampleTimes)))
sampleTimes12Mon(grep("segunda-feira", sampleTimes12Mon$sampleTimes))
length(which(wday(sampleTimes12Mon, label = T) == "segunda-feira"))
length(which(sampleTimes12Mon$sampleTimes == "segunda-feira"))
Mondays <- length(which(sampleTimes12Mon$sampleTimes == "segunda-feira"))
Mondays
36.92/6
library(ggplot2)
testdat <- data.frame(x = 1:100, y = rnorm(100))
plot(testdat$x, testdat$y, type = 'l', ylim = c(-3,3))
testdat[50,2] <- 100
plot(testdat$x, testdat$y, type = 'l', ylim = c(-3,3))
library(ggplot2)
g <- ggplot(testdat, aes(x = x, y = y))
g + geom_line()
g + geom_line + ylim(-3,3)
g + geom_line() + ylim(-3,3)
g + geom_line() + coord_cartesian(ylim = c(3,-3))
set.seed(12345)
par(mar = rep (0.2, 4))
dataMatrix <- matrix(rnorm(400), nrow = 40)
image(1:10, 1:40, t(dataMatrix)[,nrow(dataMatrix):1])
par(mar = rep(0.2, 4))
heatmap(dataMatrix)
set.seed(678910)
set.seed(678910)
for (i in 1:40){
#flip a coin
coinFlip <- rbinom(1, size = 1, prob = 0.5)
# if a coin is heads add a common pattern to the row
if (coinFlip){
dataMatrix[i,] <- dataMatrix[i,] + rep(c(0, 3), each = 5)
}
}
par(mar = rep(0.2, 4))
heatmap(dataMatrix)
image(1:10, 1:40, t(dataMatrix)[,nrow(dataMatrix):1])
heatmap(dataMatrix)
hh <- hclust(dist(dataMatrix))
dataMatrixOrdered <- dataMatrix[hh$order,]
par(mfrow = c(1,3))
image(t(dataMatrixOrdered)[, nrow(dataMatrixOrdered):1])
plot(rowMeans(dataMatrixOrdered), 40:1, xlab = "Row Mean", ylab = "Row", pch = 19)
plot(colMeans(dataMatrixOrdered), xlab = "Column", ylab = "Column Mean", pch = 19)
library(dplyr)
library(data.table)
library(ggplot2)
getWd()
getwd()
setwd("C:/Users/Marcelo/Desktop/DsStudy/CraftBeers")
?read.table
df_beer <- read.table("beers.csv", header = TRUE, sep =",")
df_beer <- data.table(read.csv("beers.csv", header = TRUE))
View(df_beer)
df_beer <- data.table(read.csv("beers.csv", header = TRUE, stringsAsFactors = FALSE))
df_brew <- data.table(read.csv("breweries.csv", header = TRUE,
stringsAsFactors = FALSE))
View(df_brew)
View(df_beer)
str(df_beer)
summary(df_beer)
head(df_brew)
head(df_beer)
View(df_beer)
?merge
full_beer_data <- merge(df_beer, df_brew, by.x = brewery_id, by.y = X)
full_beer_data <- merge(df_beer, df_brew,
by.x = df_beer$brewery_id,
by.y = df_brew$X)
full_beer_data <- merge(df_beer, df_brew,
by.x = df_beer$brewery_id,
by.y = df_brew$X,
all)
full_beer_data <- merge(df_beer, df_brew,
by.x = df_beer$brewery_id,
by.y = df_brew$X,
all= TRUE)
full_beer_data <- merge(df_beer, df_brew,
by.x = df_beer$brewery_id,
by.y = df_brew$X,
all.y = all)
full_beer_data <- merge(df_beer, df_brew,
by.x = df_beer$brewery_id,
by.y = df_brew$X,
all.x = all)
full_beer_data <- merge(df_beer, df_brew,
by = intersect (names(df_beer$brewery_id,
names(df_brew$X))))
?merge.data.table
names(df_brew)
colnames(df_brew) <- c("brewery_id", "name", "city", "state")
full_beer_data <- merge(df_beer, df_brew, by = "brewery_id")
View(full_beer_data)
head(full_beer_data)
names(full_beer_data)
colnames(full_beer_data) <- c("brewery_id", "X", "abv", "ibu", "id", "beer_name",
"style", "ounces", "brewery_name", "city", "state")
full_beer_data = full_beer_data[,3:11]
full_beer_data$abv = full_beer_data$abv*100
head(full_beer_data)
?ggplot
count(state)
count(full_beer_data$state)
ggplot
ggplot(data = full_beer_data, aes(brewery_name, state )
geom_col())
ggplot(data = full_beer_data, aes(brewery_name, state)
geom_col()
)
ggplot(data = full_beer_data, aes(brewery_name, state))+
geom_col()
ggplot(data = full_beer_data, aes(state, count(brewery_name)))+
geom_col()
ggplot(data = full_beer_data, aes(state, count(as.numeric(brewery_name))))+
geom_col()
count(as.numeric(full_beer_data$brewery_name))
counts <- as.data.frame((full_beer_data$brewery_name))
View(counts)
?count
count(counts)
count(unique(counts))
count(full_beer_data, "brewery_name")
breweryxstate < full_beer_data %>%
group_by(brewery_name)%>%
summarise(Freq = n())
breweryxstate <- full_beer_data %>%
group_by(brewery_name)%>%
summarise(Freq = n())
View(breweryxstate)
breweryxstate <- full_beer_data %>%
group_by(brewery_name)%>%
group_by(state)
View(breweryxstate)
breweryxstate <- full_beer_data %>%
group_by(brewery_name)%>%
group_by(state)%>%
summarise(Freq = n())
View(breweryxstate)
ggplot(data = breweryxstate, aes(state, Freq))+
geom_col()
ggplot(data = breweryxstate, aes(state, order(Freq))+
geom_col()
ggplot(data = breweryxstate, aes(state, order(Freq)))+
geom_col()
ggplot(data = breweryxstate, aes(state, order(Freq)))+
geom_col()
ggplot(data = breweryxstate, aes(state, Freq)) +
geom_col()
breweryxstate = breweryxstate[order(Freq)]
breweryxstate = breweryxstate[order(breweryxstate$Freq)]
?order
breweryxstate[order(Freq)]
breweryxstate[order(breweryxstate$Freq)]
ggplot(data = breweryxstate, aes(state, Freq)) +
geom_bar()
ggplot(data = breweryxstate, aes(state, Freq)) +
geom_bar()
ggplot(data = full_beer_data, aes(state, brewery_name)) +
geom_bar()
ggplot(data = full_beer_data, aes(state, brewery_name)) +
geom_bar(stat="identity")
ggplot(data = full_beer_data, aes(x = reorder(state, -value), y = brewery_name)) +
geom_bar(stat="identity")
ggplot(data = full_beer_data, aes(x = reorder(state, -brewery_name), y = brewery_name)) +
geom_bar(stat="identity")
ggplot(data = breweryxstate, aes(x = reorder(state, -Frew), y = Frew)) +
geom_bar(stat="identity")
ggplot(data = breweryxstate, aes(x = reorder(state, -Freq), y = Freq)) +
geom_bar(stat="identity")
?labels
?ggplot2
ggplot(data = breweryxstate, aes(x = reorder(state, -Freq), y = Freq)) +
geom_bar(stat="identity") +
labs(x = "State", y = "Brewery Freq")
ggplot(data = breweryxstate, aes(x = reorder(state, -Freq), y = Freq)) +
geom_bar(stat="identity") +
labs(x = "State", y = "Brewery Freq") +
geom_abline(average(Freq))
ggplot(data = breweryxstate, aes(x = reorder(state, -Freq), y = Freq)) +
geom_bar(stat="identity") +
labs(x = "State", y = "Brewery Freq") +
geom_abline(mean(Freq))
ggplot(data = breweryxstate, aes(x = reorder(state, -Freq), y = Freq)) +
geom_bar(stat="identity") +
labs(x = "State", y = "Brewery Freq") +
geom_abline(mean(breweryxstate$Freq))
ggplot(data = breweryxstate, aes(x = reorder(state, -Freq), y = Freq)) +
geom_bar(stat="identity") +
labs(x = "State", y = "Brewery Freq") +
geom_abline(mean)
ggplot(data = breweryxstate, aes(x = reorder(state, -Freq), y = Freq)) +
geom_bar(stat="identity") +
labs(x = "State", y = "Brewery Freq") +
geom_line(mean)
ggplot(data = breweryxstate, aes(x = reorder(state, -Freq), y = Freq)) +
geom_bar(stat="identity") +
labs(x = "State", y = "Brewery Freq") +
stat_summary(fun.y = "mean", geom = "line")
mean(breweryxstate$Freq)
ggplot(data = breweryxstate, aes(x = reorder(state, -Freq), y = Freq)) +
geom_bar(stat="identity") +
labs(x = "State", y = "Brewery Freq") +
stat_summary(mean(breweryxstate$Freq), geom = "line")
ggplot(data = breweryxstate, aes(x = reorder(state, -Freq), y = Freq)) +
geom_bar(stat="identity") +
labs(x = "State", y = "Brewery Freq") +
stat_summary(mean(breweryxstate$Freq), geom = "line")
ggplot(data = breweryxstate, aes(x = reorder(state, -Freq), y = Freq)) +
geom_bar(stat="identity") +
labs(x = "State", y = "Brewery Freq") +
geom_line(position = 47.25, col = "red")
ggplot(data = breweryxstate, aes(x = reorder(state, -Freq), y = Freq)) +
geom_bar(stat="identity") +
labs(x = "State", y = "Brewery Freq") +
geom_line(position = 47, col = "red")
ggplot(data = breweryxstate, aes(x = reorder(state, -Freq), y = Freq)) +
geom_bar(stat="identity") +
labs(x = "State", y = "Brewery Freq") +
geom_line()
?geom_line
ggplot(data = breweryxstate, aes(x = reorder(state, -Freq), y = factor(Freq))) +
geom_bar(stat="identity") +
labs(x = "State", y = "Brewery Freq") +
geom_line()
ggplot(data = breweryxstate, aes(x = reorder(state, -Freq), y = Freq)) +
geom_bar(stat="identity") +
labs(x = "State", y = "Brewery Freq") +
geom_line()
ggplot(data = breweryxstate, aes(x = reorder(state, -Freq), y = Freq)) +
geom_bar(stat="identity") +
labs(x = "State", y = "Brewery Freq") +
stat_summary(aes(fun.y=mean, geom="bar")
ggplot(data = breweryxstate, aes(x = reorder(state, -Freq), y = Freq)) +
geom_bar(stat="identity") +
labs(x = "State", y = "Brewery Freq") +
stat_summary(aes(fun.y=mean, geom="bar"))
ggplot(data = breweryxstate, aes(x = reorder(state, -Freq), y = Freq)) +
geom_bar(stat="identity") +
labs(x = "State", y = "Brewery Freq") +
geom_hline(data = breweryxstate$Freq, aes(yintercept=Median))
ggplot(data = breweryxstate, aes(x = reorder(state, -Freq), y = Freq)) +
geom_bar(stat="identity") +
labs(x = "State", y = "Brewery Freq") +
geom_hline(data = factor(breweryxstate$Freq), aes(yintercept=Median))
ggplot(data = breweryxstate, aes(x = reorder(state, -Freq), y = Freq)) +
geom_bar(stat="identity") +
labs(x = "State", y = "Brewery Freq") +
geom_hline(data = numeric(breweryxstate$Freq), aes(yintercept=Median))
?geom_hline
ggplot
ggplot(data = breweryxstate, aes(x = reorder(state, -Freq), y = Freq)) +
geom_bar(stat="identity") +
labs(x = "State", y = "Brewery Freq") +
geom_hline(yintercept=mean(breweryxstate$Freq))
ggplot(data = breweryxstate, aes(x = reorder(state, -Freq), y = Freq)) +
geom_bar(stat="identity") +
labs(x = "State", y = "Brewery Freq") +
geom_hline(yintercept=mean(breweryxstate$Freq), col = "red")
ggplot(data = breweryxstate, aes(x = reorder(state, -Freq), y = Freq)) +
geom_bar(stat="identity") +
labs(x = "State"(angle = 90), y = "Brewery Freq") +
geom_hline(yintercept=mean(breweryxstate$Freq), col = "red")
?labs
ggplot(data = breweryxstate, aes(x = reorder(state, -Freq), y = Freq)) +
geom_bar(stat="identity") +
labs(x = "State", y = "Brewery Freq") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))+
geom_hline(yintercept=mean(breweryxstate$Freq), col = "red")
install.packages("rmarkdown")
library(rmarkdown)
render("craft_beer.Rmd")
breweryxcity <- full_beer_data %>%
group_by(brewery_name)) %>%
group_by(city) %>%
breweryxcity <- full_beer_data %>%
group_by(brewery_name)) %>%
group_by(city)
breweryxcity <- full_beer_data %>%
group_by(brewery_name) %>%
group_by(city)
View(breweryxcity)
View(breweryxstate)
breweryxcity <- full_beer_data %>%
group_by(brewery_name) %>%
group_by(city) %>%
summarise(Freq = n())
View(breweryxcity)
breweryxcity[,which(breweryxcity[,2]>10)]
breweryxcity[which(breweryxcity[,2]>10),]
View(breweryxcity)
breweryxcity[which(breweryxcity[,2]>10),]
View(breweryxcity)
breweryxcity = breweryxcity[which(breweryxcity[,2]>10),]
ggplot(data = breweryxcity, aes(x = reorder(city, -Freq), y = Freq)) +
geom_bar(stat="identity", col = "green") +
labs(x = "State", y = "Brewery Freq") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))+
geom_hline(yintercept=mean(breweryxstate$Freq), col = "red")
ggplot(data = breweryxcity, aes(x = reorder(city, -Freq), y = Freq)) +
geom_bar(stat="identity", col = "green") +
labs(x = "State", y = "Brewery Freq") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))+
geom_hline(yintercept=mean(breweryxcity$Freq), col = "red")
ggplot(data = breweryxcity, aes(x = reorder(city, -Freq), y = Freq)) +
geom_bar(stat="identity", col = "green") +
labs(x = "City", y = "Number of Breweries") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))+
geom_hline(yintercept=mean(breweryxcity$Freq), col = "red")
ggplot(data = breweryxcity, aes(x = reorder(city, -Freq), y = Freq)) +
geom_bar(stat="identity", col = "green") +
labs(x = "City", y = "Number of Breweries", main = " City with Most Breweries") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))+
geom_hline(yintercept=mean(breweryxcity$Freq), col = "red")
?labs
ggplot(data = breweryxcity, aes(x = reorder(city, -Freq), y = Freq)) +
geom_bar(stat="identity", col = "green") +
labs(x = "City", y = "Number of Breweries", title = "Cities with Most Breweries") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))+
geom_hline(yintercept=mean(breweryxcity$Freq), col = "red")
View(breweryxcity)
View(full_beer_data)
alcoholxstate <- full_beer_data %>%
group_by(state) %>%
group_by(abv) %>%
summarise(mean = n())
View(alcoholxstate)
alcoholxstate <- full_beer_data %>%
group_by(abv) %>%
group_by(state) %>%
summarise(mean = n())
alcoholxstate <- full_beer_data %>%
group_by(abv) %>%
group_by(state) %>%
alcoholxstate <- full_beer_data %>%
group_by(abv) %>%
group_by(state)
View(alcoholxstate)
alcoholxstate <- full_beer_data %>%
group_by(abv) %>%
group_by(state) %>%
summarise()
alcoholxstate <- full_beer_data %>%
group_by(abv) %>%
group_by(state) %>%
summarise(Freq(n))
alcoholxstate <- full_beer_data %>%
group_by(abv) %>%
group_by(state) %>%
summarise(Freq = (n))
alcoholxstate <- full_beer_data %>%
group_by(abv) %>%
group_by(state) %>%
summarise(mean = (n))
alcoholxstate <- full_beer_data %>%
group_by(abv) %>%
group_by(state) %>%
summarise(mean = n())
breweryxcity <- full_beer_data %>%
group_by(style) %>%
group_by(abv) %>%
summarise(Freq = n())
abvxstyle <- full_beer_data %>%
group_by(style) %>%
group_by(abv) %>%
summarise(Freq = n())
View(abvxstyle)
abvxstyle <- full_beer_data %>%
group_by(mean(abv)) %>%
group_by(style) %>%
summarise(Freq = n())
abvxstyle <- full_beer_data %>%
group_by(mean(abv)) %>%
group_by(style)
?group_by
abvxstyle <- group_by(full_beer_data, style)
View(abvxstyle)
summarise(abvxstyle, mean(abv))
abvxstyle <- full_beer_data %>%
group_by(style, abv)
abvxstyle <- full_beer_data %>%
group_by(style, abv) %>%
summarise(abvxstyle, mean(abv))
summarise(abvxstyle, mean(abv))
abvxstyle <- full_beer_data %>%
group_by(style, abv)
summarise(abvxstyle, mean(abv))
abvxstyle <- full_beer_data %>%
group_by(style, mean(abv))
abvxstyle <- full_beer_data %>%
group_by(style, abv)
abvxstyle <- summarise(abvxstyle, mean(abv))
abvxstyle <- full_beer_data %>%
group_by(style)%>%
group_by(abv) %>%
summarise(Mean =  sum (n) / n())
abvxstyle <- full_beer_data %>%
group_by(style)%>%
group_by(abv) %>%
summarise(Mean =  sum (n) / n())
abvxstyle <- full_beer_data %>%
group_by(style)%>%
group_by(abv) %>%
summarise(Mean = sum()/n())
abvxstyle <- full_beer_data %>%
group_by(abv)%>%
group_by(style) %>%
summarise(Mean = sum()/n())
abvxstyle <- full_beer_data %>%
filter(complete.cases()) %>%
group_by(abv)%>%
group_by(style) %>%
summarise(Mean = sum()/n())
?filter
abvxstyle <- full_beer_data %>%
filter(complete.cases(.)) %>%
group_by(abv)%>%
group_by(style) %>%
summarise(Mean = sum()/n())
abvxstyle <- full_beer_data %>%
filter(!is.na(abv)) %>%
group_by(abv)%>%
group_by(style) %>%
summarise(Mean = sum()/n())
abvxstyle <- full_beer_data %>%
group_by(abv)%>%
group_by(style) %>%
summarise(Mean = sum()/n())
abvxstyle <- full_beer_data %>%
group_by(abv)%>%
group_by(style) %>%
summarise(Mean = sum())
abvxstyle <- full_beer_data %>%
group_by(abv)%>%
group_by(style) %>%
summarise(Mean = n())
abvxstyle <- full_beer_data %>%
group_by(abv)%>%
group_by(style) %>%
summarise(Mean = sum(abv))
abvxstyle <- full_beer_data %>%
group_by(abv)%>%
group_by(style) %>%
summarise(Mean = sum(abv)/n())
abvxstyle <- full_beer_data %>%
filter(!is.na(abv)) %>%
group_by(abv)%>%
group_by(style) %>%
summarise(Mean = sum(abv)/n())
ggplot(data = abvxstyle, aes(x = reorder(style, -Mean), y = Mean)) +
geom_bar(stat="identity", col = "green") +
labs(x = "City", y = "Number of Breweries", title = "Cities with Most Breweries") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))+
geom_hline(yintercept=mean(breweryxcity$Freq), col = "red")
ggplot(data = abvxstyle, aes(x = reorder(style, -Mean), y = Mean)) +
geom_bar(stat="identity", col = "green") +
labs(x = "Style", y = "average % Alcohol",
title = "Beers with highest average alcohol") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))+
geom_hline(yintercept=mean(abvxstyle$Mean), col = "red")
ggplot(data = abvxstyle, aes(x = reorder(style, -Mean), y = Mean > 6)) +
geom_bar(stat="identity", col = "green") +
labs(x = "Style", y = "average % Alcohol",
title = "Beers with highest average alcohol") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))+
geom_hline(yintercept=mean(abvxstyle$Mean), col = "red")
abvxstyle = abvxstyle[which(abvxstyle[,2]>6),]
ggplot(data = abvxstyle, aes(x = reorder(style, -Mean), y = Mean)) +
geom_bar(stat="identity", col = "green") +
labs(x = "Style", y = "average % Alcohol",
title = "Beers with highest average alcohol") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))+
geom_hline(yintercept=mean(abvxstyle$Mean), col = "red")
View(full_beer_data)
beerxstyle <- full_beer_data %>%
group_by(beer_name)%>%
group_by(style) %>%
summarise(Sum = n())
View(beerxstyle)
beerxstyle = beerxstyle[which(beerxstyle[,2]>20),]
ggplot
ggplot(data = beerxstyle, aes(x = reorder(style, -Sum), y = Sum)) +
geom_bar(stat="identity", col = "green") +
labs(x = "Style", y = "# of Beers",
title = "Most brewed Beer Styles") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))+
ggplot(data = beerxstyle, aes(x = reorder(style, -Sum), y = Sum)) +
geom_bar(stat="identity", col = "yellow") +
labs(x = "Style", y = "# of Beers",
title = "Most brewed Beer Styles") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(data = beerxstyle, aes(x = reorder(style, -Sum), y = Sum)) +
geom_bar(stat="identity", col = "grey") +
labs(x = "Style", y = "# of Beers",
title = "Most brewed Beer Styles") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
